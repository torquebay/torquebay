<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Torque Bay</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');

    body {
      font-family: 'Inter', sans-serif;
      padding: 1rem;
      max-width: 1000px;
      margin: auto;
      background: #111;
      color: #eee;
      font-size: 14px;
      line-height: 1.4;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }

    img {
      max-width: 100%;
      display: block;
    }

    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 5px;
    }

    .logo-container {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .logo-container img {
      height: 70px; /* bigger logo */
    }

    .auth-buttons a {
      color: #d32f2f;
      text-decoration: none;
      font-weight: 700;
      margin-left: 15px;
      border: 2px solid #d32f2f;
      padding: 6px 12px;
      border-radius: 5px;
      transition: background-color 0.3s ease;
      font-size: 0.9rem;
    }
    .auth-buttons a:hover {
      background-color: #d32f2f;
      color: #fff;
    }

    .rolling-text-container {
      overflow: hidden;
      white-space: nowrap;
      border-top: 3px solid #d32f2f;
      border-bottom: 3px solid #d32f2f;
      margin: 1rem 0 1rem 0;
      padding: 10px 0;
    }
    .rolling-text {
      display: inline-block;
      padding-left: 100%;
      animation: scroll 15s linear infinite;
      color: #d32f2f;
      font-weight: 700;
      font-size: 1rem;
    }
    @keyframes scroll {
      0% { transform: translateX(0); }
      100% { transform: translateX(-100%); }
    }

    #auctionEnds {
      position: relative;
      margin-bottom: 1rem;
      font-weight: 900;
      color: #fff;
      font-size: 1.1rem;
      text-align: right;
      user-select: none;
      text-shadow: 0 0 5px #000;
    }

    main.container {
      flex-grow: 1;
    }

    /* Filters */
    #filtersForm {
      margin-bottom: 20px;
      display: flex;
      gap: 15px;
      flex-wrap: wrap;
      align-items: center;
      color: #eee;
    }

    #filtersForm label {
      font-weight: 600;
      user-select: none;
    }

    #filtersForm select,
    #filtersForm input[type="text"] {
      padding: 5px 8px;
      font-size: 0.9rem;
      border-radius: 5px;
      border: 1px solid #555;
      background: #222;
      color: #eee;
      min-width: 120px;
    }
    #filtersForm input[type="text"] {
      flex-grow: 1;
      min-width: 150px;
    }

    /* Listings */
    article.listing {
      border: 1px solid #444;
      border-radius: 8px;
      background: #222;
      padding: 15px;
      margin-bottom: 25px;
      box-shadow: 0 0 10px rgba(211, 47, 47, 0.3);
      display: flex;
      gap: 20px;
      flex-wrap: nowrap;
      position: relative;
      align-items: flex-start;
      font-size: 14px;
    }

    article.listing h3 {
      margin-top: 0;
      color: #d32f2f;
      font-size: 1.4rem;
      flex-basis: 100%;
    }

    .tag {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      color: #4caf50;
      font-weight: 600;
      margin-bottom: 5px;
    }
    .tag svg {
      width: 18px;
      height: 18px;
      fill: currentColor;
    }

    .gallery {
      flex: 0 0 220px;
      display: flex;
      flex-direction: column;
      gap: 10px;
      max-width: 220px;
    }

    .gallery img {
      border-radius: 6px;
      cursor: pointer;
      border: 2px solid transparent;
      transition: border-color 0.3s ease;
      max-height: 110px;
      object-fit: cover;
    }

    .gallery img.selected {
      border-color: #d32f2f;
    }

    .main-image-container {
      flex: 0 0 400px;
      max-width: 400px;
      position: relative;
    }

    #mainImage {
      border-radius: 8px;
      cursor: zoom-in;
      transition: transform 0.3s ease;
      object-fit: contain;
      max-height: 300px;
      width: 100%;
      display: block;
    }

    #mainImage.zoomed {
      cursor: zoom-out;
      transform: scale(2);
      z-index: 10;
      position: relative;
    }

    .info-section {
      flex: 1 1 320px;
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
      gap: 15px;
      color: #eee;
      max-width: 320px;
      min-width: 280px;
    }

    .price {
      font-size: 1.6rem;
      font-weight: 900;
      color: #ff6f00; /* orange */
      margin: 0;
      letter-spacing: 1.5px;
      text-align: center;
      text-shadow: none;
    }

    .actions button,
    .actions input[type="number"],
    .actions label {
      display: block;
      width: 100%;
      margin-bottom: 10px;
      font-weight: 600;
    }

    .actions button {
      cursor: pointer;
      padding: 10px;
      border-radius: 6px;
      border: none;
      font-size: 1rem;
      font-weight: 700;
      transition: background-color 0.3s ease;
    }

    .buy-now-price {
      background-color: #ff6f00;
      color: white;
    }
    .buy-now-price:hover {
      background-color: #e65c00;
    }

    #bidAmount {
      padding: 8px;
      font-size: 1rem;
      border-radius: 6px;
      border: 1px solid #444;
      background: #222;
      color: #eee;
      box-sizing: border-box;
    }

    #bidBtn {
      background-color: #4caf50;
      color: white;
      border: none;
    }
    #bidBtn:hover {
      background-color: #388e3c;
    }

    .contact-seller {
      background-color: #388e3c;
      color: white;
      border: none;
      font-weight: 700;
      padding: 10px;
      border-radius: 6px;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }
    .contact-seller:hover {
      background-color: #2e7031;
    }

    .description {
      margin-top: 15px;
      line-height: 1.4;
      font-size: 0.9rem;
      color: #ddd;
      flex-grow: 1;
      max-height: 140px;
      overflow-y: auto;
      padding-right: 5px;
    }

    footer {
      margin-top: auto;
      text-align: center;
      padding: 1rem 0;
      font-size: 0.85rem;
      color: #666;
      border-top: 1px solid #333;
    }

    /* Responsive */
    @media (max-width: 850px) {
      #auctionEnds {
        position: static;
        margin-bottom: 1rem;
        text-align: center;
      }
      article.listing {
        flex-direction: column;
        align-items: center;
      }
      .gallery {
        max-width: 100%;
        flex-direction: row;
        overflow-x: auto;
      }
      .gallery img {
        max-width: 100px;
        max-height: 80px;
      }
      .main-image-container,
      .info-section,
      .description {
        max-width: 100%;
        width: 100%;
      }

      #filtersForm {
        justify-content: center;
      }
    }
  </style>
</head>
<body>

  <header role="banner" aria-label="Site header with logo and authentication">
    <div class="logo-container">
      <img src="https://i.ibb.co/gL9ttQ1k/logo.jpg" alt="Torque Bay Logo" />
      <h1 style="font-size:1.6rem; margin:0; user-select:none;">Torque Bay â€“ Car Auctions & Sales</h1>
    </div>
    <nav class="auth-buttons" aria-label="User authentication actions">
      <a href="login.html" id="loginLink">Login</a>
      <a href="register.html" id="registerLink">Register</a>
    </nav>
  </header>

  <div class="rolling-text-container" aria-live="polite" aria-atomic="true" role="region" aria-label="Site updates scrolling message">
    <div class="rolling-text">
      ðŸš— Updates coming soon! â€“ Email TorqueBay@gmail.com for enquiries & membership info. Stay tuned! ðŸš€
    </div>
  </div>

  <form id="filtersForm" aria-label="Filter car listings">
    <label for="searchInput">Search:</label>
    <input type="text" id="searchInput" placeholder="Search by title or model" aria-describedby="searchHelp" />
    <label for="modelFilter">Model:</label>
    <select id="modelFilter">
      <option value="">All</option>
      <option value="Astra">Astra</option>
      <option value="Corsa">Corsa</option>
      <option value="Insignia">Insignia</option>
    </select>
    <label for="conditionFilter">Condition:</label>
    <select id="conditionFilter">
      <option value="">All</option>
      <option value="runner">Runner</option>
      <option value="non-runner">Non-runner</option>
    </select>
    <label for="mileageFilter">Sort Mileage:</label>
    <select id="mileageFilter">
      <option value="">None</option>
      <option value="asc">Low to High</option>
      <option value="desc">High to Low</option>
    </select>
  </form>

  <div id="auctionEnds" aria-live="polite" aria-atomic="true">Auction Ends In: 23h 59m 59s</div>

  <main class="container" role="main" aria-label="Car auction and sales listings">
    <div id="listingsContainer" aria-live="polite" aria-atomic="true">
      <!-- Listings injected here -->
    </div>
  </main>

  <!-- Contact Modal -->
  <dialog id="contactModal" aria-modal="true" role="dialog" aria-labelledby="contactModalTitle">
    <form id="contactForm">
      <h2 id="contactModalTitle">Contact Seller</h2>
      <p>Please enter your phone number and we will contact you shortly regarding the listing.</p>
      <label for="phoneNumber">Phone Number:</label><br />
      <input type="tel" id="phoneNumber" name="phoneNumber" placeholder="+44 7000 000000" required autocomplete="tel" /><br /><br />
      <button type="submit">Send</button>
      <button type="button" id="closeContactModalBtn">Cancel</button>
    </form>
  </dialog>

  <footer role="contentinfo">
    TorqueBay 2025 All Rights Reserved &copy;
  </footer>

  <script>
    // Dummy listings data, currently only one Astra listing
    const listingsData = [
      {
        id: 'astra2010',
        title: 'Vauxhall Astra J 1.4 Turbo 2010 A14NET',
        model: 'Astra',
        condition: 'runner',
        mileage: 89905,
        price: 1750,
        buyNowPrice: 1999,
        description: `This Vauxhall Astra J 1.4 Turbo (A14NET) from 2010 offers a balanced mix of performance and efficiency. Powered by a 1.4L turbocharged petrol engine producing around 138 hp, it delivers spirited acceleration while maintaining reasonable fuel economy. Typical MPG is approximately 40-45 mpg combined, making it suitable for both city and highway driving. Recently serviced with a full year MOT, it runs and drives reliably. Perfect for daily driving or as a budget-friendly sporty hatchback.`,
        images: [
          'https://i.ibb.co/5x4fty6V/2025-07-05-18-30-25-401.jpg',
          'https://i.ibb.co/20LT3MMB/2025-07-05-18-30-42-743.jpg',
          'https://i.ibb.co/k692dv4t/2025-07-05-18-31-00-391.jpg',
          'https://i.ibb.co/PzPSzjVq/2025-07-05-18-31-07-371.jpg'
        ]
      }
      // Add more listings here later if needed
    ];

    // Authentication simulation (replace with real auth)
    let token = localStorage.getItem('token') || null;

    const listingsContainer = document.getElementById('listingsContainer');
    const auctionEndsEl = document.getElementById('auctionEnds');

    // Format numbers with commas
    function formatNumber(num) {
      return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');
    }

    // Render a single listing card
    function renderListing(listing) {
      const listingEl = document.createElement('article');
      listingEl.className = 'listing';
      listingEl.setAttribute('tabindex', '0');
      listingEl.setAttribute('aria-label', `Listing: ${listing.title}, Price Â£${formatNumber(listing.price)}`);

      // Image gallery HTML
      const galleryImgsHtml = listing.images.map((img, idx) =>
        `<img src="${img}" alt="${listing.title} image ${idx + 1}" class="${idx === 0 ? 'selected' : ''}" tabindex="0" />`
      ).join('');

      listingEl.innerHTML = `
        <h3>${listing.title}</h3>
        <div class="gallery" aria-label="Image gallery">${galleryImgsHtml}</div>
        <div class="main-image-container">
          <img src="${listing.images[0]}" alt="${listing.title}" id="mainImage" />
        </div>
        <section class="info-section">
          <div class="tag" aria-label="${listing.condition === 'runner' ? 'Runner car' : 'Non-runner car'}">
            ${listing.condition === 'runner' ? `
            <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg> Runner` : `<span style="color:#d32f2f; font-weight:bold;">Non-runner</span>`}
          </div>
          <p><strong>Mileage:</strong> ${formatNumber(listing.mileage)} miles</p>
          <p class="price">Â£${formatNumber(listing.price)}</p>
          <p><strong>Buy It Now:</strong> Â£${formatNumber(listing.buyNowPrice)}</p>
          <p class="description">${listing.description}</p>
          <div class="actions" aria-label="Bid and purchase actions">
            <form id="bidForm" aria-label="Place your bid">
              <label for="bidAmount">Your Bid (Â£):</label>
              <input type="number" min="${listing.price + 1}" id="bidAmount" name="bidAmount" placeholder="Â£${listing.price + 1}" required />
              <button type="submit" id="bidBtn">Place Bid</button>
            </form>
            <button class="buy-now-price" id="buyNowBtn">Buy It Now Â£${formatNumber(listing.buyNowPrice)}</button>
            <button class="contact-seller" id="contactSellerBtn">Contact Seller</button>
          </div>
        </section>
      `;

      listingsContainer.appendChild(listingEl);

      // Gallery images click handler
      const galleryImgs = listingEl.querySelectorAll('.gallery img');
      const mainImg = listingEl.querySelector('#mainImage');
      galleryImgs.forEach(img => {
        img.addEventListener('click', () => {
          galleryImgs.forEach(i => i.classList.remove('selected'));
          img.classList.add('selected');
          mainImg.src = img.src;
          mainImg.alt = img.alt;
        });
        img.addEventListener('keydown', e => {
          if(e.key === 'Enter' || e.key === ' ') {
            e.preventDefault();
            img.click();
          }
        });
      });

      // Main image zoom toggle
      mainImg.addEventListener('click', () => {
        mainImg.classList.toggle('zoomed');
      });

      // Bid form submit handler
      const bidForm = listingEl.querySelector('#bidForm');
      bidForm.addEventListener('submit', e => {
        e.preventDefault();
        if(!token) {
          alert('You must be logged in to place a bid. Please login or register.');
          return;
        }
        const bidVal = Number(bidForm.bidAmount.value);
        if(bidVal <= listing.price) {
          alert(`Bid must be greater than current price (Â£${listing.price})`);
          return;
        }
        alert(`Your bid of Â£${formatNumber(bidVal)} has been placed!`);
        bidForm.reset();
      });

      // Buy now button handler
      const buyNowBtn = listingEl.querySelector('#buyNowBtn');
      buyNowBtn.addEventListener('click', () => {
        if(!token) {
          alert('You must be logged in to buy the car now. Please login or register.');
          return;
        }
        if(confirm(`Are you sure you want to buy "${listing.title}" now for Â£${formatNumber(listing.buyNowPrice)}?`)) {
          alert('Congratulations! You have purchased the car. The seller will contact you shortly.');
        }
      });

      // Contact seller button handler
      const contactSellerBtn = listingEl.querySelector('#contactSellerBtn');
      contactSellerBtn.addEventListener('click', () => {
        currentListingId = listing.id;
        contactModal.showModal();
        document.getElementById('phoneNumber').focus();
      });
    }

    // Filter listings based on user input
    function filterListings() {
      const searchTerm = document.getElementById('searchInput').value.toLowerCase();
      const modelFilter = document.getElementById('modelFilter').value.toLowerCase();
      const conditionFilter = document.getElementById('conditionFilter').value.toLowerCase();
      const mileageFilter = document.getElementById('mileageFilter').value;

      let filtered = listingsData.filter(listing => {
        const matchesSearch = listing.title.toLowerCase().includes(searchTerm) || listing.model.toLowerCase().includes(searchTerm);
        const matchesModel = modelFilter ? listing.model.toLowerCase() === modelFilter : true;
        const matchesCondition = conditionFilter ? listing.condition.toLowerCase() === conditionFilter : true;
        return matchesSearch && matchesModel && matchesCondition;
      });

      // Mileage sort
      if (mileageFilter === 'asc') {
        filtered.sort((a,b) => a.mileage - b.mileage);
      } else if (mileageFilter === 'desc') {
        filtered.sort((a,b) => b.mileage - a.mileage);
      }

      listingsContainer.innerHTML = '';
      if(filtered.length === 0) {
        listingsContainer.innerHTML = '<p>No listings found.</p>';
      } else {
        filtered.forEach(listing => renderListing(listing));
      }
    }

    // Auction countdown timer
    let countdownTime = 24 * 60 * 60; // 24h in seconds
    function updateCountdown() {
      const auctionEndsEl = document.getElementById('auctionEnds');
      if(countdownTime <= 0) {
        auctionEndsEl.textContent = 'Auction Ended';
        clearInterval(countdownInterval);
        return;
      }
      const hrs = Math.floor(countdownTime / 3600);
      const mins = Math.floor((countdownTime % 3600) / 60);
      const secs = countdownTime % 60;
      auctionEndsEl.textContent = `Auction Ends In: ${hrs}h ${mins}m ${secs}s`;
      countdownTime--;
    }
    updateCountdown();
    const countdownInterval = setInterval(updateCountdown, 1000);

    // Contact seller modal logic
    const contactModal = document.getElementById('contactModal');
    const contactForm = document.getElementById('contactForm');
    const closeContactModalBtn = document.getElementById('closeContactModalBtn');
    let currentListingId = null;

    closeContactModalBtn.addEventListener('click', () => {
      contactModal.close();
      contactForm.reset();
    });

    contactForm.addEventListener('submit', e => {
      e.preventDefault();
      const phoneNumber = contactForm.phoneNumber.value.trim();
      if(phoneNumber.length < 6) {
        alert('Please enter a valid phone number.');
        return;
      }
      // Here you could send phoneNumber and currentListingId to your backend/email API
      alert(`Thank you! We will contact you shortly at ${phoneNumber} regarding listing "${currentListingId}".`);
      contactForm.reset();
      contactModal.close();
    });

    // Filter input events
    document.getElementById('searchInput').addEventListener('input', filterListings);
    document.getElementById('modelFilter').addEventListener('change', filterListings);
    document.getElementById('conditionFilter').addEventListener('change', filterListings);
    document.getElementById('mileageFilter').addEventListener('change', filterListings);

    // Initial render
    filterListings();
  </script>

</body>
</html>
